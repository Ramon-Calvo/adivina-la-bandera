(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var e=`https://restcountries.com/v3.1`,t=class{countries=[];async fetchAllCountries(){try{let t=await fetch(`${e}/all?fields=name,flags,cca2`);if(!t.ok)throw Error(`Error al obtener las banderas`);return this.countries=await t.json(),this.countries}catch(e){throw console.error(`Error al obtener los países:`,e),e}}getRandomCountries(e){return[...this.countries].sort(()=>Math.random()-.5).slice(0,e)}getRandomCountry(){let e=Math.floor(Math.random()*this.countries.length);return this.countries[e]}get allCountries(){return this.countries}},n=class{api;state;elements;constructor(){this.api=new t,this.state={score:0,streak:0,currentCountry:null,options:[],answered:!1}}initElements(){this.elements={flagImage:document.getElementById(`flag-image`),optionsContainer:document.getElementById(`options`),scoreDisplay:document.getElementById(`score`),streakDisplay:document.getElementById(`streak`),feedbackDisplay:document.getElementById(`feedback`),nextButton:document.getElementById(`next-btn`),resetButton:document.getElementById(`reset-btn`),loadingDisplay:document.getElementById(`loading`),gameContainer:document.getElementById(`game-container`)}}async init(){this.initElements(),this.showLoading(!0);try{await this.api.fetchAllCountries(),this.setupEventListeners(),this.loadNewQuestion(),this.showLoading(!1)}catch(e){console.error(`Error al inicializar el juego:`,e),this.elements.feedbackDisplay.textContent=`Error al cargar las banderas. Por favor, recarga la página.`,this.elements.feedbackDisplay.classList.remove(`hidden`)}}setupEventListeners(){this.elements.nextButton.addEventListener(`click`,()=>{this.loadNewQuestion()}),this.elements.resetButton.addEventListener(`click`,()=>{this.resetGame()})}loadNewQuestion(){this.state.answered=!1,this.elements.feedbackDisplay.classList.add(`hidden`),this.elements.nextButton.classList.add(`hidden`);let e=this.api.getRandomCountry(),t=this.api.getRandomCountries(3).filter(t=>t.cca2!==e.cca2).slice(0,3);this.state.currentCountry=e,this.state.options=[...t,e].sort(()=>Math.random()-.5),this.renderQuestion()}renderQuestion(){this.state.currentCountry&&(this.elements.flagImage.src=this.state.currentCountry.flags.svg,this.elements.flagImage.alt=`Bandera de ${this.state.currentCountry.name.common}`,this.elements.optionsContainer.innerHTML=``,this.state.options.forEach(e=>{let t=document.createElement(`button`);t.className=`option-btn`,t.textContent=e.name.common,t.addEventListener(`click`,()=>this.handleAnswer(e)),this.elements.optionsContainer.appendChild(t)}))}handleAnswer(e){if(this.state.answered||!this.state.currentCountry)return;this.state.answered=!0;let t=e.cca2===this.state.currentCountry.cca2;this.elements.optionsContainer.querySelectorAll(`.option-btn`).forEach(n=>{let r=n;r.disabled=!0,r.textContent===this.state.currentCountry.name.common&&r.classList.add(`correct`),r.textContent===e.name.common&&!t&&r.classList.add(`incorrect`)}),t?(this.state.score+=10,this.state.streak+=1,this.showFeedback(`¡Respuesta correcta!`,`success`)):(this.state.streak=0,this.showFeedback(`Incorrecto. La respuesta correcta es ${this.state.currentCountry.name.common}`,`error`)),this.updateDisplay(),this.elements.nextButton.classList.remove(`hidden`)}showFeedback(e,t){this.elements.feedbackDisplay.textContent=e,this.elements.feedbackDisplay.className=`feedback ${t}`}updateDisplay(){this.elements.scoreDisplay.textContent=`${this.state.score}`,this.elements.streakDisplay.textContent=`${this.state.streak}`}resetGame(){this.state.score=0,this.state.streak=0,this.updateDisplay(),this.loadNewQuestion()}showLoading(e){e?(this.elements.loadingDisplay.classList.remove(`hidden`),this.elements.gameContainer.classList.add(`hidden`)):(this.elements.loadingDisplay.classList.add(`hidden`),this.elements.gameContainer.classList.remove(`hidden`))}};window.addEventListener(`load`,()=>{new n().init()});